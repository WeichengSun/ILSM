<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculating the number of 48 motifs — icmotif_count • ILSM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculating the number of 48 motifs — icmotif_count"><meta property="og:description" content="Calculating the number of 48 motifs from a tripartite interaction network."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ILSM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/motif_guideline.html">motif_guideline</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/WeichengSun/ILSM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculating the number of 48 motifs</h1>
    <small class="dont-index">Source: <a href="https://github.com/WeichengSun/ILSM/blob/main/R/icmotif_count.R" class="external-link"><code>R/icmotif_count.R</code></a></small>
    <div class="hidden name"><code>icmotif_count.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculating the number of 48 motifs from a tripartite interaction network.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">icmotif_count</span><span class="op">(</span><span class="va">network.or.subnet_mat1</span>, subnet_mat2 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-network-or-subnet-mat-">network.or.subnet_mat1<a class="anchor" aria-label="anchor" href="#arg-network-or-subnet-mat-"></a></dt>
<dd><p>Either a tripartite network of 'igraph' class which contains three groups of species and interactions within subnetwork without interactions between each group of species, or a numeric matrix(or data.frame) representing interactions between two groups of species.
Each row and column of matrix represents single species in the second and first groups of the tripartite network respectively.
Elements of matrix are non-zero numbers if the two groups of species are connected, and 0 otherwise.</p></dd>


<dt id="arg-subnet-mat-">subnet_mat2<a class="anchor" aria-label="anchor" href="#arg-subnet-mat-"></a></dt>
<dd><p>A numeric matrix(or data.frame) representing interactions between two groups of species.
Each row and column of matrix represents single species in the second and third groups of the tripartite network respectively.
Elements of matrix are non-zero numbers if the two groups of species are connected, and 0 otherwise. If <code>network.or.subnet_mat1</code> is "igraph", <code>subnet_mat2</code> defaults to NULL.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Return a numeric vector with the number of 48 motifs: M111, M112, M113, M114, M211, M212, M213, M311, M312, M411, M121_1, M122_1, M122_2, M122_3,
M123_1, M123_2, M123_3, M123_4, M123_5, M221_1, M221_2, M221_3, M222_1, M222_2, M222_3, M222_4, M222_5, M222_6, M222_7, M222_8, M222_8, M321_1, M321_2,
M321_3, M321_4, M321_5, M131, M132-1, M132-2, M132-3, M132-4, M132-5, M231-1, M231-2, M231-3, M231-4, M231-5, M141.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>network.or.subnet_mat1 and subnet_mat2</strong></p>
<p>There are two types of <code>network.or.subnet_mat1</code> that can be processed:</p><ul><li><p>Input in a network of type "igraph" alone.</p></li>
<li><p>Must be entered as data frame or matrix with <code>subnet_mat2</code>.</p></li>
</ul><p>If the type of inputting is data frame or matrix, please make sure the row of <code>network.or.subnet_mat1</code> and <code>subnet_mat2</code> correspond with the second group of species that both belong to two subnetworks and interact with other groups of species.</p><ul><li><p>Try to make the rows of both matrices have the same attributes. Or we default:</p></li>
<li><p>When the two matrices can have different numbers of rows:</p><ul><li><p>1. If both matrices have row names, then the function counts all row names to produce two new matrices with the same row names.</p></li>
<li><p>2. If at most one matrix has row names, the function assigns new row names to both matrices on a row-to-row basis (any extra row names are assigned a new value) and then counts all row names to produce two new matrices with the same row names.</p></li>
</ul></li>
<li><p>When the two matrices can have the same numbers of rows:</p><ul><li><p>No matter how the row names of the two matrices are arranged, as long as the row names are exactly the same; But we don't handle matrices with empty row names (the function will give an error).</p></li>
</ul></li>
<li><p>The two matrices can have different numbers of rows, but read our default handling carefully to make sure the calculation is accurate when using this function!!!</p></li>
</ul><p>About a network of type "igraph", It can be obtained from the connection matrices of subnetworks by the function <code>igraph_from_matrices</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Pilosof, S., Porter, M. A., Pascual, M., &amp; Kéfi, S. (2017). The multilayer nature of ecological networks. Nature Ecology &amp; Evolution, 1(4), 0101.</p>
<p>Simmons, B. I., Sweering, M. J., Schillinger, M., Dicks, L. V., Sutherland, W. J., &amp; Di Clemente, R. (2019). bmotif: A package for motif analyses of bipartite networks. Methods in Ecology and Evolution, 10(5), 695-701.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## generate a random tripartite network</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Net</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_net.html">build_net</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">15</span>,<span class="fl">16</span>,<span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PPH_Coltparkmeadow</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Net</span> <span class="op">&lt;-</span> <span class="va">PPH_Coltparkmeadow</span></span></span>
<span class="r-in"><span><span class="fu">icmotif_count</span><span class="op">(</span><span class="va">Net</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]     612    1341    1754    1836   10801   22680   24570  134437  278640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] 1269020     123     581     335     180    1818     400     516     180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]     180    2429    4755     969   25549    3496   10309    6387    2427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28]    2800    6840    1530    8124   47962   53347   39968   38250    4930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37]      11     204      55       0      44       0     219     550      59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46]     154      55       0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MAT</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_net.html">build_net</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">22</span>,<span class="fl">21</span>,<span class="fl">0.2</span>,asmatrices<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">icmotif_count</span><span class="op">(</span><span class="va">MAT</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  230  489  649  599  212  471  663   92  223   18  112 1238  745   45 3722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 1150 1146  280    6  709  347   20 4005  162 4778 1271  127  287  146    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 1113  963  190  255   46    2   31  860  253  303   53    3  499  112  120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46]   30    2    4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">md1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">120</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">8</span>,<span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">md2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">120</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">10</span>,<span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">icmotif_count</span><span class="op">(</span><span class="va">md1</span>,<span class="va">md2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> re-check whether the row name of network.or.subnet_mat1 is corresponding to the row name of subnet_mat2!!!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  320  890 1497 1713  989 2890 5131 1815 5570 2179  251  735 1396  344 1976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 1781 1623 1788  267  932 1693  333 4695  964 5107 5245 1903 1201 2385  487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 4057 2754 2477 2698 2146  234  118  515  518  467  472   74  671  614  537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46]  540   62   36</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">12</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">MR</span> <span class="op">&lt;-</span> <span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">12</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">-</span><span class="fl">12</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>,<span class="va">MR</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">22</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">R</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">icmotif_count</span><span class="op">(</span><span class="va">MAT</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">MAT</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  230  489  649  599  212  471  663   92  223   18  112 1238  745   45 3722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 1150 1146  280    6  709  347   20 4005  162 4778 1271  127  287  146    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 1113  963  190  255   46    2   31  860  253  303   53    3  499  112  120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46]   30    2    4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Weicheng Sun, Chuan Yan, Yangyang Zhao.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

